# Agent2Agent (A2A) Protocol Specification

**Version:** `0.1.0`

## 1. Introduction

The Agent2Agent (A2A) Protocol is an open standard designed to facilitate communication and interoperability between independent, potentially opaque AI agent systems. In an ecosystem where agents might be built using different frameworks, languages, or vendors, A2A provides a common language and interaction model. This enables agents to discover each other's capabilities, negotiate interaction modalities (text, files, structured data), manage collaborative tasks, and securely exchange information to achieve user goals without needing access to each other's internal state, memory, or tools.

**Key Goals:**

- **Interoperability:** Bridge the gap between disparate agentic systems.
- **Collaboration:** Enable agents to delegate tasks, exchange context, and work together on complex user requests.
- **Discovery:** Allow agents to dynamically find and understand the capabilities of other agents.
- **Flexibility:** Support various interaction modes (text, files, forms, streaming).
- **Security:** Facilitate secure communication patterns suitable for enterprise environments.
- **Asynchronicity:** Support long-running tasks and interactions that may involve human-in-the-loop scenarios.

This document provides the detailed technical specification for the A2A protocol, defining its data structures, communication methods, and core concepts.

## 2. Core Concepts

Understanding these core concepts is essential for implementing or interacting with A2A-compliant agents:

- **A2A Client:** An entity (service, application, or another agent) that initiates requests to an A2A Server on behalf of a user to accomplish a task.
- **A2A Server (Remote Agent):** An agentic system that exposes an HTTP endpoint implementing the A2A protocol. It receives requests from clients, processes tasks, and returns results or status updates. It operates opaquely from the client's perspective.
- **Agent Card:** A standardized JSON metadata document, typically hosted at `/.well-known/agent.json`, describing an A2A Server's identity, capabilities (e.g., streaming support), skills, communication endpoint (`url`), and authentication requirements. Clients use this for discovery. See [Section 5](#5-agent-discovery-the-agent-card).
- **Task:** The fundamental unit of work within the A2A protocol. A client initiates a task (e.g., "Generate a report", "Answer this question") by sending an initial message. Each task has a unique ID and progresses through a defined lifecycle ([`TaskState`](#63-taskstate-enum)). See [Section 6.1](#61-task-object).
- **Message:** A unit of communication within a Task, representing a turn in the conversation. Messages have a `role` ("user" for client-sent messages, "agent" for server-sent messages) and contain one or more `Part` objects. See [Section 6.4](#64-message-object).
- **Part:** The smallest unit of content within a `Message` or `Artifact`. Can be [`TextPart`](#651-textpart-object) (plain text), [`FilePart`](#652-filepart-object) (binary data, referenced by URI or inline bytes), or [`DataPart`](#653-datapart-object) (structured JSON data, e.g., for forms). See [Section 6.5](#65-part-union-type).
- **Artifact:** Represents an output or result generated by the agent during task processing (e.g., a generated document, an image, structured data). Artifacts contain one or more `Part` objects and can be streamed. See [Section 6.7](#67-artifact-object).
- **Streaming:** For tasks that may take time or produce incremental results, A2A supports Server-Sent Events (SSE). A client uses the [`tasks/sendSubscribe`](#72-taskssendsubscribe) method, and the server pushes [`TaskStatusUpdateEvent`](#722-taskstatusupdateevent-object) and [`TaskArtifactUpdateEvent`](#723-taskartifactupdateevent-object) messages over the connection.
- **Push Notifications:** For long-running tasks where maintaining an SSE connection is impractical, A2A allows servers to proactively send updates to a client-provided webhook URL. This is configured per task using [`tasks/pushNotification/set`](#75-taskspushnotificationset). See [Section 6.8](#68-pushnotificationconfig-object).
- **Session:** An optional client-provided identifier (`sessionId`) that can group multiple related tasks together. See [Section 6.1](#61-task-object).

## 3. Transport and Format

- **Transport:** A2A communication occurs over HTTP(S).
- **Data Format:** A2A uses **JSON-RPC 2.0** as the payload format for all requests and responses. See [Section 6.11](#611-json-rpc-structures).
- **Streaming Transport:** When streaming is used ([`tasks/sendSubscribe`](#72-taskssendsubscribe), [`tasks/resubscribe`](#77-tasksresubscribe)), the server sends updates using **Server-Sent Events (SSE)** over the established HTTP connection. Each SSE `data` field contains a JSON-RPC 2.0 Response object ([`SendTaskStreamingResponse`](#721-sendtaskstreamingresponse-object)).

## 4. Authentication and Authorization

A2A treats agents as standard enterprise applications, relying on established web security practices rather than defining new ones within the protocol payload.

- **Transport Security:** Production deployments MUST use HTTPS with modern TLS configurations.
- **Server Identity:** Clients SHOULD verify the server's identity using its TLS certificate.
- **Client/User Identity:** Identity information is NOT transmitted within A2A JSON-RPC payloads. Authentication requirements are declared in the [`AgentCard`](#51-agentcard-object).
- **Authentication Process:**
  1.  The client discovers the server's required authentication schemes via the `AgentCard`. See [`AgentAuthentication`](#54-agentauthentication-object).
  2.  The client obtains the necessary credentials (e.g., API keys, OAuth tokens, JWTs) through an out-of-band process specific to the required scheme.
  3.  The client includes these credentials in the HTTP headers (e.g., `Authorization: Bearer <token>`) of every A2A request.
- **Server Responsibility:** The A2A Server MUST authenticate every incoming request. It SHOULD use standard HTTP status codes (401 Unauthorized, 403 Forbidden) and relevant headers (e.g., `WWW-Authenticate`) for challenges or rejections.
- **In-Task Authentication:** If an agent requires additional credentials _during_ a task (e.g., to access a specific tool on behalf of the user), it should transition the task to the `input-required` state ([`TaskState`](#63-taskstate-enum)) and provide necessary details (potentially using an [`AuthenticationInfo`](#69-authenticationinfo-object) structure within a [`DataPart`](#653-datapart-object)). The client obtains these credentials out-of-band and provides them in a subsequent [`tasks/send`](#71-taskssend) request.
- **Authorization:** Servers are responsible for authorizing requests based on the authenticated client/user identity. Authorization MAY be enforced based on specific skills requested ([`AgentSkill`](#55-agentskill-object)) or actions attempted within the task.

_(See also [Enterprise Readiness Topic](https://google.github.io/A2A/#/topics/enterprise_ready.md))_

## 5. Agent Discovery: The Agent Card

A2A Servers MUST publish an Agent Card, a JSON document describing their capabilities and how to interact with them.

- **Recommended Location:** `https://{server_domain}/.well-known/agent.json`
- **Discovery Methods:** Clients can find Agent Cards via the well-known path, curated registries, or private mechanisms. _(See [Agent Discovery Topic](https://google.github.io/A2A/#/topics/agent_discovery.md))_
- **Security:** Agent Cards containing sensitive information (like default credentials) MUST be protected by appropriate access controls (e.g., mTLS, authentication).

### 5.1. `AgentCard` Object

Describes the A2A Server (Remote Agent).

| Field Name           | Type                                                              | Required | Description                                                                                                               |
| :------------------- | :---------------------------------------------------------------- | :------- | :------------------------------------------------------------------------------------------------------------------------ |
| `name`               | `string`                                                          | Yes      | Human-readable name of the agent (e.g., "Recipe Agent").                                                                  |
| `description`        | `string` \| `null`                                                | No       | Human-readable description of the agent's purpose. CommonMark MAY be used.                                                |
| `url`                | `string`                                                          | Yes      | The base URL endpoint for the agent's A2A service (where JSON-RPC requests are sent).                                     |
| `provider`           | [`AgentProvider`](#52-agentprovider-object) \| `null`             | No       | Information about the organization providing the agent.                                                                   |
| `version`            | `string`                                                          | Yes      | Version string for the agent or its A2A implementation (format defined by provider).                                      |
| `documentationUrl`   | `string` \| `null`                                                | No       | URL pointing to human-readable documentation for the agent.                                                               |
| `capabilities`       | [`AgentCapabilities`](#53-agentcapabilities-object)               | Yes      | Specifies optional features supported by the agent (streaming, push notifications, etc.).                                 |
| `authentication`     | [`AgentAuthentication`](#54-agentauthentication-object) \| `null` | No       | Authentication schemes required to interact with the agent. Intended to align with OpenAPI Auth.                          |
| `defaultInputModes`  | `string[]`                                                        | No       | Array of MIME types the agent generally accepts as input (e.g., "text/plain", "image/png"). Default: `["text"]`.          |
| `defaultOutputModes` | `string[]`                                                        | No       | Array of MIME types the agent generally produces as output (e.g., "text/plain", "application/json"). Default: `["text"]`. |
| `skills`             | [`AgentSkill[]`](#55-agentskill-object)                           | Yes      | An array of specific skills or capabilities the agent offers.                                                             |

### 5.2. `AgentProvider` Object

Information about the organization providing the agent.

| Field Name     | Type               | Required | Description                                  |
| :------------- | :----------------- | :------- | :------------------------------------------- |
| `organization` | `string`           | Yes      | Name of the organization.                    |
| `url`          | `string` \| `null` | No       | URL for the provider's organization website. |

### 5.3. `AgentCapabilities` Object

Specifies optional protocol features supported by the agent.

| Field Name               | Type      | Required | Default | Description                                                                                                                                                               |
| :----------------------- | :-------- | :------- | :------ | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `streaming`              | `boolean` | No       | `false` | If `true`, the agent supports [`tasks/sendSubscribe`](#72-taskssendsubscribe) and [`tasks/resubscribe`](#77-tasksresubscribe) via SSE.                                    |
| `pushNotifications`      | `boolean` | No       | `false` | If `true`, the agent supports [`tasks/pushNotification/set`](#75-taskspushnotificationset) and [`tasks/pushNotification/get`](#76-taskspushnotificationget).              |
| `stateTransitionHistory` | `boolean` | No       | `false` | If `true`, the agent may include a detailed history of status changes within the [`Task`](#61-task-object) object (mechanism not fully detailed in current spec version). |

### 5.4. `AgentAuthentication` Object

Describes the authentication requirements for the agent, mirroring OpenAPI structure.

| Field Name    | Type               | Required | Description                                                                                                                                                                   |
| :------------ | :----------------- | :------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `schemes`     | `string[]`         | Yes      | Array of authentication scheme names supported/required (e.g., "Bearer", "Basic", "OAuth2").                                                                                  |
| `credentials` | `string` \| `null` | No       | Optional field, potentially containing static credentials like an API key _if_ appropriate and secured. Usage is generally discouraged in favor of dynamic token acquisition. |

### 5.5. `AgentSkill` Object

Describes a specific capability or function the agent can perform.

| Field Name    | Type                 | Required | Description                                                                              |
| :------------ | :------------------- | :------- | :--------------------------------------------------------------------------------------- |
| `id`          | `string`             | Yes      | A unique identifier for this skill within the agent (e.g., "currency-converter").        |
| `name`        | `string`             | Yes      | Human-readable name of the skill (e.g., "Currency Conversion").                          |
| `description` | `string` \| `null`   | No       | Detailed description of what the skill does. CommonMark MAY be used.                     |
| `tags`        | `string[]` \| `null` | No       | Array of keywords for categorization (e.g., ["finance", "conversion"]).                  |
| `examples`    | `string[]` \| `null` | No       | Array of example prompts or use cases for this skill (e.g., ["convert 100 USD to EUR"]). |
| `inputModes`  | `string[]` \| `null` | No       | Overrides `defaultInputModes` specifically for this skill. If null, defaults apply.      |
| `outputModes` | `string[]` \| `null` | No       | Overrides `defaultOutputModes` specifically for this skill. If null, defaults apply.     |

## 6. Protocol Data Objects

These objects define the structure of data exchanged via JSON-RPC methods.

### 6.1. `Task` Object

Represents the stateful unit of work being processed by the agent.

| Field Name  | Type                                          | Required | Description                                                                                                 |
| :---------- | :-------------------------------------------- | :------- | :---------------------------------------------------------------------------------------------------------- |
| `id`        | `string`                                      | Yes      | Unique identifier for the task, typically generated by the client.                                          |
| `sessionId` | `string` \| `null`                            | No       | Optional client-generated identifier to group related tasks.                                                |
| `status`    | [`TaskStatus`](#62-taskstatus-object)         | Yes      | The current status (state, message, timestamp) of the task.                                                 |
| `artifacts` | [`Artifact[]`](#67-artifact-object) \| `null` | No       | Array of outputs generated by the agent for this task.                                                      |
| `history`   | [`Message[]`](#64-message-object) \| `null`   | No       | Optional array of recent messages exchanged within this task, if requested via `historyLength`.             |
| `metadata`  | `object` \| `null`                            | No       | Arbitrary key-value metadata associated with the task. Keys should be strings, values can be any JSON type. |

### 6.2. `TaskStatus` Object

Represents the current state and associated context of a `Task`.

| Field Name  | Type                                             | Required | Description                                                                                                 |
| :---------- | :----------------------------------------------- | :------- | :---------------------------------------------------------------------------------------------------------- |
| `state`     | [`TaskState`](#63-taskstate-enum)                | Yes      | The current lifecycle state of the task.                                                                    |
| `message`   | [`Message`](#64-message-object) \| `null`        | No       | An optional message associated with the current status (e.g., progress update, final result, input prompt). |
| `timestamp` | `string` (ISO 8601 format `date-time`) \| `null` | No       | The date and time when this status was recorded.                                                            |

### 6.3. `TaskState` Enum

Defines the possible lifecycle states of a `Task`.

| Value            | Description                                                         |
| :--------------- | :------------------------------------------------------------------ |
| `submitted`      | Task received by the server, but processing has not yet started.    |
| `working`        | Task is actively being processed by the agent.                      |
| `input-required` | Agent requires additional input from the client/user to proceed.    |
| `completed`      | Task finished successfully.                                         |
| `canceled`       | Task was canceled by the client or potentially by the server.       |
| `failed`         | Task terminated due to an error during processing.                  |
| `unknown`        | The state of the task cannot be determined (e.g., task ID invalid). |

### 6.4. `Message` Object

Represents a single communication turn within a `Task`.

| Field Name | Type                            | Required | Description                                                                                                    |
| :--------- | :------------------------------ | :------- | :------------------------------------------------------------------------------------------------------------- |
| `role`     | `"user"` \| `"agent"`           | Yes      | Indicates the sender: "user" for client messages, "agent" for server messages.                                 |
| `parts`    | [`Part[]`](#65-part-union-type) | Yes      | An array containing the content of the message, broken down into one or more parts.                            |
| `metadata` | `object` \| `null`              | No       | Arbitrary key-value metadata associated with the message. Keys should be strings, values can be any JSON type. |

### 6.5. `Part` Union Type

Represents a distinct piece of content within a `Message` or `Artifact`. A `Part` object includes a `metadata` field (optional `object`) and is **one** of the following specific types identified by its `type` field:

#### 6.5.1. `TextPart` Object

| Field Name | Type               | Required | Description              |
| :--------- | :----------------- | :------- | :----------------------- |
| `type`     | `"text"`           | Yes      | Identifies this as text. |
| `text`     | `string`           | Yes      | The textual content.     |
| `metadata` | `object` \| `null` | No       | Part-specific metadata.  |

#### 6.5.2. `FilePart` Object

| Field Name | Type                                    | Required | Description                     |
| :--------- | :-------------------------------------- | :------- | :------------------------------ |
| `type`     | `"file"`                                | Yes      | Identifies this as a file.      |
| `file`     | [`FileContent`](#66-filecontent-object) | Yes      | Contains the file details/data. |
| `metadata` | `object` \| `null`                      | No       | Part-specific metadata.         |

#### 6.5.3. `DataPart` Object

| Field Name | Type               | Required | Description                                                     |
| :--------- | :----------------- | :------- | :-------------------------------------------------------------- |
| `type`     | `"data"`           | Yes      | Identifies this as structured data.                             |
| `data`     | `object`           | Yes      | The structured JSON data payload (e.g., form data, parameters). |
| `metadata` | `object` \| `null` | No       | Part-specific metadata.                                         |

### 6.6. `FileContent` Object

Represents the data or reference for a file within a `FilePart`.

| Field Name | Type               | Required | Description                                                               |
| :--------- | :----------------- | :------- | :------------------------------------------------------------------------ |
| `name`     | `string` \| `null` | No       | The original filename.                                                    |
| `mimeType` | `string` \| `null` | No       | The MIME type of the file (e.g., "image/png", "application/pdf").         |
| `bytes`    | `string` \| `null` | No       | Base64 encoded string of the file content. Mutually exclusive with `uri`. |
| `uri`      | `string` \| `null` | No       | A URI pointing to the file content. Mutually exclusive with `bytes`.      |

_Constraint:_ Exactly one of `bytes` or `uri` MUST be provided if file content is intended. An empty `FileContent` object is permitted but discouraged.

### 6.7. `Artifact` Object

Represents an output generated by the agent during a task.

| Field Name    | Type                            | Required | Default | Description                                                                                                                                                                                    |
| :------------ | :------------------------------ | :------- | :------ | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `name`        | `string` \| `null`              | No       |         | A descriptive name for the artifact (e.g., "report.pdf", "analysis_results").                                                                                                                  |
| `description` | `string` \| `null`              | No       |         | A human-readable description of the artifact. CommonMark MAY be used.                                                                                                                          |
| `parts`       | [`Part[]`](#65-part-union-type) | Yes      |         | An array containing the content of the artifact.                                                                                                                                               |
| `index`       | `integer`                       | No       | `0`     | An index for ordering artifacts, especially useful for streaming updates to the same logical artifact.                                                                                         |
| `append`      | `boolean` \| `null`             | No       |         | If `true` (used with streaming), indicates this artifact update should append its `parts` to the artifact at the same `index`. If `false` or `null`, it replaces the artifact at that `index`. |
| `lastChunk`   | `boolean` \| `null`             | No       |         | If `true` (used with streaming), indicates this is the final update for the artifact at this `index`.                                                                                          |
| `metadata`    | `object` \| `null`              | No       |         | Arbitrary key-value metadata associated with the artifact. Keys should be strings, values can be any JSON type.                                                                                |

### 6.8. `PushNotificationConfig` Object

Configuration for sending push notifications for a task. _(See [Push Notifications Topic](https://google.github.io/A2A/#/topics/push_notifications.md))_

| Field Name       | Type                                                            | Required | Description                                                                                                                                                                 |
| :--------------- | :-------------------------------------------------------------- | :------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `url`            | `string`                                                        | Yes      | The webhook URL where the A2A Server should POST task updates.                                                                                                              |
| `token`          | `string` \| `null`                                              | No       | An optional, client-generated token (e.g., a secret or task-specific identifier) that the server SHOULD include in the notification request for validation by the receiver. |
| `authentication` | [`AuthenticationInfo`](#69-authenticationinfo-object) \| `null` | No       | Authentication details the A2A Server needs to use when calling the `url`. The receiver (webhook endpoint) defines these requirements.                                      |

### 6.9. `AuthenticationInfo` Object

Generic structure for specifying authentication requirements, typically used within `PushNotificationConfig`.

| Field Name    | Type               | Required | Description                                                                             |
| :------------ | :----------------- | :------- | :-------------------------------------------------------------------------------------- |
| `schemes`     | `string[]`         | Yes      | Array of authentication scheme names the caller (A2A Server) must use (e.g., "Bearer"). |
| `credentials` | `string` \| `null` | No       | Optional field for static credentials if applicable (usage depends on the scheme).      |

### 6.10. `TaskPushNotificationConfig` Object

Used in [`tasks/pushNotification/set`](#75-taskspushnotificationset) and [`tasks/pushNotification/get`](#76-taskspushnotificationget) methods to associate a push configuration with a specific task.

| Field Name               | Type                                                          | Required | Description                                        |
| :----------------------- | :------------------------------------------------------------ | :------- | :------------------------------------------------- |
| `id`                     | `string`                                                      | Yes      | The ID of the task to configure notifications for. |
| `pushNotificationConfig` | [`PushNotificationConfig`](#68-pushnotificationconfig-object) | Yes      | The push notification configuration details.       |

### 6.11. JSON-RPC Structures

A2A utilizes standard JSON-RPC 2.0 structures.

- **`JSONRPCRequest`**: Contains `jsonrpc: "2.0"`, `method` (string), `params` (object or array), and optional `id` (string \| number \| null). `id` should be present for requests expecting a response, null or absent for notifications.
- **`JSONRPCResponse`**: Contains `jsonrpc: "2.0"`, `id` (matching request, required if request had one), and _either_ `result` (any JSON value, including null) _or_ `error` ([`JSONRPCError`](#612-jsonrpcerror-object)).
- **`JSONRPCMessage`**: Base type, includes `jsonrpc: "2.0"` and optional `id`.

### 6.12. `JSONRPCError` Object

Standard JSON-RPC error structure used in responses when a request fails.

| Field Name | Type            | Required | Description                                                             |
| :--------- | :-------------- | :------- | :---------------------------------------------------------------------- |
| `code`     | `integer`       | Yes      | A number indicating the error type. See [Section 8](#8-error-handling). |
| `message`  | `string`        | Yes      | A short, human-readable summary of the error.                           |
| `data`     | `any` \| `null` | No       | Optional additional details about the error.                            |

## 7. Protocol RPC Methods

All methods are invoked via HTTP POST requests to the agent's `url` specified in its `AgentCard`. The request body MUST be a `JSONRPCRequest` object, and the response body MUST be a `JSONRPCResponse` object (or an SSE stream of them for subscribe methods).

### 7.1. `tasks/send`

**Description:** Sends a message to initiate or continue a task. Used for synchronous request/response interactions or as part of a polling mechanism for long-running tasks.

- **Request `params`**: [`TaskSendParams`](#711-tasksendparams-object)
- **Response `result`**: [`Task`](#61-task-object) object representing the final state of the task _after_ processing this message synchronously.
- **Response `error`**: [`JSONRPCError`](#612-jsonrpcerror-object) if the request fails.

#### 7.1.1. `TaskSendParams` Object

| Field Name         | Type                                                                    | Required | Description                                                                                                                                      |
| :----------------- | :---------------------------------------------------------------------- | :------- | :----------------------------------------------------------------------------------------------------------------------------------------------- |
| `id`               | `string`                                                                | Yes      | The ID of the task to send the message to. If the task doesn't exist, the server typically creates it with this ID.                              |
| `sessionId`        | `string` \| `null`                                                      | No       | Optional client-generated ID to group this task with others. If omitted for a new task, the server might generate one internally.                |
| `message`          | [`Message`](#64-message-object)                                         | Yes      | The message content to send (e.g., initial user query, response to an `input-required` prompt).                                                  |
| `pushNotification` | [`PushNotificationConfig`](#68-pushnotificationconfig-object) \| `null` | No       | Optional. If provided when initiating a task, sets the push notification configuration. May update config for existing tasks (server dependent). |
| `historyLength`    | `integer` \| `null`                                                     | No       | If provided and non-zero, requests the server to include up to the last N messages in the `history` field of the returned `Task` object.         |
| `metadata`         | `object` \| `null`                                                      | No       | Arbitrary metadata associated with this specific `tasks/send` request.                                                                           |

### 7.2. `tasks/sendSubscribe`

**Description:** Sends a message to initiate or continue a task and subscribes the client to receive real-time updates for that task via Server-Sent Events (SSE). Requires the server to have the `streaming` capability enabled in its `AgentCard`.

- **Request `params`**: [`TaskSendParams`](#711-tasksendparams-object)
- **Response**:
  - **Success**: An HTTP 2xx response with `Content-Type: text/event-stream`. The body contains a stream of SSE messages. Each message's `data` field holds a [`SendTaskStreamingResponse`](#721-sendtaskstreamingresponse-object) JSON object.
  - **Failure**: A standard HTTP error response (e.g., 4xx, 5xx) with a `JSONRPCResponse` body containing an `error` field if the initial request fails immediately.

#### 7.2.1. `SendTaskStreamingResponse` Object (SSE Event Data)

This is a standard `JSONRPCResponse` structure used within the SSE stream.

| Field Name | Type                                                                                                                                            | Required | Description                                                          |
| :--------- | :---------------------------------------------------------------------------------------------------------------------------------------------- | :------- | :------------------------------------------------------------------- |
| `jsonrpc`  | `"2.0"`                                                                                                                                         | Yes      | JSON-RPC version.                                                    |
| `id`       | `string` \| `number`                                                                                                                            | Yes      | Matches the `id` of the corresponding `tasks/sendSubscribe` request. |
| `result`   | **Either** [`TaskStatusUpdateEvent`](#722-taskstatusupdateevent-object) **or** [`TaskArtifactUpdateEvent`](#723-taskartifactupdateevent-object) | Yes      | Contains the task status update or artifact data.                    |
| `error`    | [`JSONRPCError`](#612-jsonrpcerror-object) \| `null`                                                                                            | No       | Present if an error occurs during stream processing.                 |

#### 7.2.2. `TaskStatusUpdateEvent` Object

Carries information about a change in the task's status during streaming.

| Field Name | Type                                  | Required | Default | Description                                                                                                                                                                                                                                                                  |
| :--------- | :------------------------------------ | :------- | :------ | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `id`       | `string`                              | Yes      |         | The ID of the task being updated.                                                                                                                                                                                                                                            |
| `status`   | [`TaskStatus`](#62-taskstatus-object) | Yes      |         | The new status object for the task.                                                                                                                                                                                                                                          |
| `final`    | `boolean`                             | No       | `false` | If `true`, indicates this is the terminal status update for this specific `tasks/sendSubscribe` interaction cycle (e.g., the task reached `completed`, `failed`, `canceled`, or `input-required`). Further interactions require a new `tasks/send` or `tasks/sendSubscribe`. |
| `metadata` | `object` \| `null`                    | No       |         | Arbitrary metadata associated with this specific status update event.                                                                                                                                                                                                        |

#### 7.2.3. `TaskArtifactUpdateEvent` Object

Carries a new or updated artifact generated during streaming.

| Field Name | Type                              | Required | Description                                                                                                                      |
| :--------- | :-------------------------------- | :------- | :------------------------------------------------------------------------------------------------------------------------------- |
| `id`       | `string`                          | Yes      | The ID of the task that generated the artifact.                                                                                  |
| `artifact` | [`Artifact`](#67-artifact-object) | Yes      | The artifact data. This could be a complete artifact or a chunk for incremental delivery (using `index`, `append`, `lastChunk`). |
| `metadata` | `object` \| `null`                | No       | Arbitrary metadata associated with this specific artifact update event.                                                          |

### 7.3. `tasks/get`

**Description:** Retrieves the current state, including status and any generated artifacts, of a specific task. Useful for polling or fetching the final result after a notification.

- **Request `params`**: [`TaskQueryParams`](#731-taskqueryparams-object)
- **Response `result`**: [`Task`](#61-task-object) object representing the current snapshot of the task.
- **Response `error`**: [`JSONRPCError`](#612-jsonrpcerror-object), e.g., [`TaskNotFoundError`](#82-a2a-specific-errors) if the task ID is invalid or expired.

#### 7.3.1. `TaskQueryParams` Object

| Field Name      | Type                | Required | Description                                                                                                                       |
| :-------------- | :------------------ | :------- | :-------------------------------------------------------------------------------------------------------------------------------- |
| `id`            | `string`            | Yes      | The ID of the task to retrieve.                                                                                                   |
| `historyLength` | `integer` \| `null` | No       | If provided and non-zero, requests the server to include up to the last N messages in the `history` field of the returned `Task`. |
| `metadata`      | `object` \| `null`  | No       | Arbitrary metadata associated with this specific `tasks/get` request.                                                             |

### 7.4. `tasks/cancel`

**Description:** Requests the cancellation of an ongoing task. Success is not guaranteed (e.g., the task might complete before the cancellation is processed).

- **Request `params`**: [`TaskIdParams`](#741-taskidparams-object)
- **Response `result`**: [`Task`](#61-task-object) object reflecting the state after the cancellation request (ideally `state: "canceled"`).
- **Response `error`**: [`JSONRPCError`](#612-jsonrpcerror-object), e.g., [`TaskNotFoundError`](#82-a2a-specific-errors) or [`TaskNotCancelableError`](#82-a2a-specific-errors).

#### 7.4.1. `TaskIdParams` Object

| Field Name | Type               | Required | Description                              |
| :--------- | :----------------- | :------- | :--------------------------------------- |
| `id`       | `string`           | Yes      | The ID of the task to attempt to cancel. |
| `metadata` | `object` \| `null` | No       | Arbitrary metadata for this request.     |

### 7.5. `tasks/pushNotification/set`

**Description:** Sets or updates the push notification configuration for a specific task. Allows the server to send updates to a webhook when the client is disconnected. Requires the server to have the `pushNotifications` capability enabled.

- **Request `params`**: [`TaskPushNotificationConfig`](#610-taskpushnotificationconfig-object)
- **Response `result`**: [`TaskPushNotificationConfig`](#610-taskpushnotificationconfig-object) confirming the configuration that was set (server MAY omit sensitive details like tokens).
- **Response `error`**: [`JSONRPCError`](#612-jsonrpcerror-object), e.g., [`PushNotificationNotSupportedError`](#82-a2a-specific-errors), [`TaskNotFoundError`](#82-a2a-specific-errors).

### 7.6. `tasks/pushNotification/get`

**Description:** Retrieves the currently configured push notification settings for a specific task. Requires the server to have the `pushNotifications` capability enabled.

- **Request `params`**: [`TaskIdParams`](#741-taskidparams-object)
- **Response `result`**: [`TaskPushNotificationConfig`](#610-taskpushnotificationconfig-object) containing the current configuration (or null/empty if none is set). Server MAY omit sensitive details.
- **Response `error`**: [`JSONRPCError`](#612-jsonrpcerror-object), e.g., [`PushNotificationNotSupportedError`](#82-a2a-specific-errors), [`TaskNotFoundError`](#82-a2a-specific-errors).

### 7.7. `tasks/resubscribe`

**Description:** Allows a client to reconnect to the SSE stream for an ongoing task after a network interruption or disconnection. Requires the server to have the `streaming` capability enabled.

- **Request `params`**: [`TaskQueryParams`](#731-taskqueryparams-object) (Note: `historyLength` might be ignored on resubscribe).
- **Response**:
  - **Success**: An HTTP 2xx response with `Content-Type: text/event-stream`. The body contains a stream of subsequent SSE messages for the task. Each message's `data` field holds a [`SendTaskStreamingResponse`](#721-sendtaskstreamingresponse-object) JSON object. The server's behavior regarding missed events is implementation-dependent (it might replay some state or simply resume with new updates).
  - **Failure**: A standard HTTP error response (e.g., 4xx, 5xx) with a `JSONRPCResponse` body containing an `error` field (e.g., `TaskNotFoundError`, streaming not supported for task).

## 8. Error Handling

A2A uses standard JSON-RPC error codes, plus defines custom codes for protocol-specific errors. Errors are returned in the `error` field of a `JSONRPCResponse`. See [`JSONRPCError` Object](#612-jsonrpcerror-object).

### 8.1. Standard JSON-RPC Errors

| Code                 | Constant (`a2a.json` Title) | Message                          | Description                                                  |
| :------------------- | :-------------------------- | :------------------------------- | :----------------------------------------------------------- |
| `-32700`             | `JSONParseError`            | Invalid JSON payload             | Server received invalid JSON.                                |
| `-32600`             | `InvalidRequestError`       | Request payload validation error | JSON is valid, but not a valid JSON-RPC Request object.      |
| `-32601`             | `MethodNotFoundError`       | Method not found                 | The requested `method` does not exist on the server.         |
| `-32602`             | `InvalidParamsError`        | Invalid parameters               | The `params` provided for the method are invalid or missing. |
| `-32603`             | `InternalError`             | Internal error                   | An unexpected error occurred on the server side.             |
| `-32000` to `-32099` | _(Server defined)_          | _(Server defined)_               | Reserved for implementation-specific server errors.          |

### 8.2. A2A Specific Errors

| Code     | Constant (`a2a.json` Title)         | Message                            | Description                                                                      |
| :------- | :---------------------------------- | :--------------------------------- | :------------------------------------------------------------------------------- |
| `-32001` | `TaskNotFoundError`                 | Task not found                     | The specified task `id` was not found on the server.                             |
| `-32002` | `TaskNotCancelableError`            | Task cannot be canceled            | The task is already in a terminal state (`completed`, `failed`, `canceled`).     |
| `-32003` | `PushNotificationNotSupportedError` | Push Notification is not supported | The server agent does not support the push notification feature.                 |
| `-32004` | `UnsupportedOperationError`         | This operation is not supported    | The requested high-level operation or capability is not supported by the agent.  |
| `-32005` | `ContentTypeNotSupportedError`      | Incompatible content types         | A content type in the request is not supported by the agent or the target skill. |

## 9. Common Workflows & Examples

_(Note: Timestamps and session IDs in examples are illustrative)_

### 9.1. Basic Task Execution (Synchronous / Polling)

1.  **Client -> Server:** Send `tasks/send` request with initial message and new `taskId`.

    ```json
    {
      "jsonrpc": "2.0",
      "id": 101,
      "method": "tasks/send",
      "params": {
        "id": "task-abc-123",
        "message": {
          "role": "user",
          "parts": [
            { "type": "text", "text": "What is the capital of France?" }
          ]
        }
      }
    }
    ```

2.  **Server -> Client:** Server processes synchronously and returns the final `Task` object.

    ```json
    {
      "jsonrpc": "2.0",
      "id": 101,
      "result": {
        "id": "task-abc-123",
        "sessionId": "session-xyz-789",
        "status": {
          "state": "completed",
          "timestamp": "2024-10-27T10:00:00Z"
        },
        "artifacts": [
          {
            "index": 0,
            "parts": [
              { "type": "text", "text": "The capital of France is Paris." }
            ]
          }
        ],
        "history": null,
        "metadata": null
      }
    }
    ```

    _(Alternatively, for long tasks, the server might immediately return `state: "working"`, and the client would later poll using `tasks/get` with `id: "task-abc-123"`)_

### 9.2. Streaming Task Execution

1.  **Client -> Server:** Send `tasks/sendSubscribe` request.

    ```json
    {
      "jsonrpc": "2.0",
      "id": 201,
      "method": "tasks/sendSubscribe",
      "params": {
        "id": "task-stream-456",
        "message": {
          "role": "user",
          "parts": [
            { "type": "text", "text": "Write a short story about a robot." }
          ]
        }
      }
    }
    ```

2.  **Server -> Client (SSE Stream):** Server sends multiple `SendTaskStreamingResponse` events over HTTP `text/event-stream`.

    ```sse
    id: 201
    event: message
    data: {"jsonrpc":"2.0","id":201,"result":{"id":"task-stream-456","status":{"state":"working","message":{"role":"agent","parts":[{"type":"text","text":"Okay, starting the story..."}],"metadata":null},"timestamp":"2024-10-27T10:05:01Z"},"final":false,"metadata":null}}

    id: 201
    event: message
    data: {"jsonrpc":"2.0","id":201,"result":{"id":"task-stream-456","artifact":{"name":null,"description":null,"parts":[{"type":"text","text":"Unit 734 booted up. ","metadata":null}],"index":0,"append":false,"lastChunk":false,"metadata":null},"metadata":null}}

    id: 201
    event: message
    data: {"jsonrpc":"2.0","id":201,"result":{"id":"task-stream-456","artifact":{"name":null,"description":null,"parts":[{"type":"text","text":"Its optical sensors scanned the desolate landscape...","metadata":null}],"index":0,"append":true,"lastChunk":false,"metadata":null},"metadata":null}}

    id: 201
    event: message
    data: {"jsonrpc":"2.0","id":201,"result":{"id":"task-stream-456","artifact":{"name":null,"description":null,"parts":[{"type":"text","text":" It missed the rain.","metadata":null}],"index":0,"append":true,"lastChunk":true,"metadata":null},"metadata":null}}

    id: 201
    event: message
    data: {"jsonrpc":"2.0","id":201,"result":{"id":"task-stream-456","status":{"state":"completed","message":null,"timestamp":"2024-10-27T10:05:05Z"},"final":true,"metadata":null}}
    ```

### 9.3. Multi-Turn Interaction (Input Required)

1.  **Client -> Server:** Initial `tasks/send` (or `tasks/sendSubscribe`).

    ```json
    {
      "jsonrpc": "2.0",
      "id": 301,
      "method": "tasks/send",
      "params": {
        "id": "task-multi-789",
        "message": {
          "role": "user",
          "parts": [{ "type": "text", "text": "Book a flight for me." }]
        }
      }
    }
    ```

2.  **Server -> Client:** Server requires input, responds with `state: "input-required"`.

    ```json
    {
      "jsonrpc": "2.0",
      "id": 301,
      "result": {
        "id": "task-multi-789",
        "sessionId": "session-abc-123",
        "status": {
          "state": "input-required",
          "timestamp": "2024-10-27T10:10:00Z",
          "message": {
            "role": "agent",
            "parts": [
              { "type": "text", "text": "Where would you like to fly to?" }
            ],
            "metadata": null
          }
        },
        "artifacts": null,
        "history": null,
        "metadata": null
      }
    }
    ```

    _(If using streaming, this status update would arrive in a `TaskStatusUpdateEvent` with `final: true`)_

3.  **Client -> Server:** Client provides the requested input using the _same_ `taskId`.

    ```json
    {
      "jsonrpc": "2.0",
      "id": 302,
      "method": "tasks/send",
      "params": {
        "id": "task-multi-789",
        "sessionId": "session-abc-123",
        "message": {
          "role": "user",
          "parts": [{ "type": "text", "text": "Paris" }]
        }
      }
    }
    ```

    _(Could also use `tasks/sendSubscribe` again to continue streaming if needed)_

4.  **Server -> Client:** Server proceeds and eventually completes (or asks for more input).

    ```json
    {
      "jsonrpc": "2.0",
      "id": 302,
      "result": {
        "id": "task-multi-789",
        "sessionId": "session-abc-123",
        "status": { "state": "completed" /*...*/ },
        "artifacts": [
          /* ... flight confirmation details ... */
        ]
        /*...*/
      }
    }
    ```

    _(Or via an SSE stream if `tasks/sendSubscribe` was used in step 3)_

### 9.4. Push Notification Setup and Usage

1.  **Client -> Server:** Initiate a task and set notification config simultaneously using `tasks/send`.

    ```json
    {
      "jsonrpc": "2.0",
      "id": 401,
      "method": "tasks/send",
      "params": {
        "id": "task-long-run-101",
        "message": {
          "role": "user",
          "parts": [
            {
              "type": "text",
              "text": "Generate the quarterly sales report. Notify me when done."
            }
          ]
        },
        "pushNotification": {
          "url": "https://client.example.com/a2a_webhook",
          "token": "secure-task-token-101",
          "authentication": { "schemes": ["Bearer"] } // Server needs a Bearer token to call webhook
        }
      }
    }
    ```

2.  **Server -> Client:** Server acknowledges task submission (likely with `state: "submitted"` or `"working"`).

    ```json
    {
      "jsonrpc": "2.0",
      "id": 401,
      "result": {
        "id": "task-long-run-101",
        "status": { "state": "submitted" /*...*/ }
        /*...*/
      }
    }
    ```

3.  **(Later) Server -> Webhook URL:** When the task completes, the server makes an authenticated POST request to `https://client.example.com/a2a_webhook`.
    - **Request Headers:**
      - `Authorization: Bearer <server_obtained_token>` (Server gets this token using info from `pushNotification.authentication`, e.g., client credentials flow, or pre-shared key signed JWT).
      - `Content-Type: application/json`
      - May include `X-A2A-Token: secure-task-token-101` (if `token` was provided).
    - **Request Body:** (Payload format is convention-based, but should include task info)

        ```json
        {
        "taskId": "task-long-run-101",
        "status": {
            "state": "completed",
            "timestamp": "2024-10-27T18:30:00Z"
        }
        // Might include full Task object or just key info
        }
        ```

4.  **Webhook -> Client:** The webhook endpoint verifies the incoming request (checks signature/token) and notifies the original client application.
5.  **Client -> Server:** Client can optionally call `tasks/get` to retrieve the full `Task` object including artifacts.

    ```json
    {
      "jsonrpc": "2.0",
      "id": 402,
      "method": "tasks/get",
      "params": { "id": "task-long-run-101" }
    }
    ```

## 10. Appendices

### 10.1. Relationship to MCP (Model Context Protocol)

- **MCP:** Focuses on connecting agents/models to **tools, APIs, and resources** with structured inputs/outputs. It defines how an agent _uses_ a capability provided by an external system (which could be a simple API or another agent acting as a tool).
- **A2A:** Focuses on communication **between agentic systems themselves**, facilitating collaboration, task delegation, and exchange of conversational context or higher-level results _as peers_.
- **Complementary:** They address different levels of interaction. An agent (Client) might use A2A to ask another agent (Server) to perform a complex task. The Server agent might then use MCP to interact with several underlying tools (databases, APIs) to fulfill that A2A task. An A2A agent's `AgentCard` _can_ potentially be represented or discovered via MCP mechanisms if it's intended to be used like a structured tool by another system.

_(See [A2A ❤️ MCP Topic](https://google.github.io/A2A/#/topics/a2a_and_mcp.md))_

### 10.2. Security Considerations Summary

- **Transport:** Always use HTTPS with robust TLS settings in production.
- **Authentication:** Handled via standard HTTP headers (e.g., `Authorization`). A2A payloads are identity-agnostic. Requirements are advertised in `AgentCard`. Clients obtain credentials out-of-band. Servers MUST validate credentials on every request.
- **Authorization:** Server-side responsibility based on authenticated identity. Granularity may depend on requested skills or actions within a task.
- **Push Notifications:** Introduce additional security points:
  - **Server:** Validate webhook URLs. Use secure methods (JWT signed with JWKS-retrieved keys, OAuth Client Credentials, etc.) to authenticate _to_ the webhook endpoint as specified in `PushNotificationConfig.authentication`.
  - **Webhook Endpoint:** Verify the authenticity and integrity of incoming notifications (e.g., validate JWT signature, check provided `token`). Prevent replay attacks (e.g., using timestamps, nonces within signed payloads).
- **Input Validation:** Servers must rigorously validate all inputs received via RPC parameters, including data within `Part` objects, to prevent injection or processing attacks.
- **Resource Management:** Servers should implement rate limiting and resource controls to prevent denial-of-service from malicious or runaway clients.
